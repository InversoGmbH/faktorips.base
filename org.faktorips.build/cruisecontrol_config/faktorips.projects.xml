<!DOCTYPE project [ <!ENTITY mailmapping SYSTEM "mailmapping.txt"> ]>

<!--======================================================================================================-->
<!-- Faktor IPS project definition for Cruise Control (cc)                                                -->
<!-- by using the ant script './generate.cc.config.xml' a new config.xml file could be re-generated       -->
<!-- based on the project definition defined in this file                                                 -->
<!--======================================================================================================-->
<faktoripscruisecontrol>

    <!-- global properties -->
    <property name="workdir" value="checkout"/>
    <property name="mainbuildfile" value="build-faktorips.xml"/>
    <property name="logdir" value="logs"/>

    <!-- cvs property -->
    <property name="cvsroot" value="/usr/local/cvsroot"/>
    <property name="buildresultsurl" value="http://www.faktorzehn.org/cruisecontrol/buildresults"/>
    
    <!-- mail properties -->
    <property name="htmlemail.mailhost" value="62.245.204.82"/>
    <property name="htmlemail.returnaddress" value="cc@faktorips.org"/>
    <property name="htmlemail.xsldir" value="/opt/cc/webapps/cruisecontrol/xsl/"/>
    <property name="htmlemail.css" value="/opt/cc/docs/cruisecontrol.css"/>
    <property name="htlmemail.reportWhenFixed.address" value="faktorips-devel@faktorzehn.de"/>

    <!-- cc project definitions -->
    <projects>
        <project name="org.faktorips.util" mainbuildtarget="util">
        </project>
        <project name="org.faktorips.valuetypes" mainbuildtarget="valuetypes">
            <depends>
                <project name="org.faktorips.util"/>
            </depends>
        </project>
        <project name="org.faktorips.valuetypes.java5" mainbuildtarget="valuetypes.java5">
            <depends>
                <project name="org.faktorips.util"/>
            </depends>
        </project>        
        <project name="org.faktorips.dtflcommon" mainbuildtarget="dtflcommon">
            <depends>
                <project name="org.faktorips.valuetypes"/>
                <project name="org.faktorips.util"/>
            </depends>            
        </project>
        <project name="org.faktorips.runtime" mainbuildtarget="runtime">
            <depends>
                <project name="org.faktorips.valuetypes"/>
                <project name="org.faktorips.util"/>
            </depends>               
        </project>
        <project name="org.faktorips.runtime.java5" mainbuildtarget="runtime.java5">
            <depends>
                <project name="org.faktorips.valuetypes.java5"/>
                <project name="org.faktorips.util"/>
            </depends>               
        </project>        
        <project name="org.faktorips.fl" mainbuildtarget="fl">
            <depends>
                <project name="org.faktorips.dtflcommon"/>
            </depends>                      
        </project>
        <project name="org.faktorips.devtools.core" mainbuildtarget="devtools.core">
            <depends>
                <project name="org.faktorips.fl"/>
            </depends>
        </project>
        <project name="org.faktorips.devtools.stdbuilder" mainbuildtarget="devtools.stdbuilder">
            <depends>
                <project name="org.faktorips.fl"/>
                <project name="org.faktorips.runtime"/>
                <project name="org.faktorips.devtools.core"/>
            </depends>            
        </project>
        <project name="org.faktorips.devtools.core.ui" mainbuildtarget="devtools.core.ui">
            <depends>
                <project name="org.faktorips.devtools.core"/>
            </depends>
        </project>
        <project name="org.faktorips.devtools.ant" mainbuildtarget="devtools.ant" 
            testresult="${workdir}/${project.name}/scripts/">
        </project>

        <project name="org.faktorips.pluginbuilder" mainbuildtarget="pluginbuilder.faktorips"
            testresult="${workdir}/../pluginbuilder_tmp/org.faktorips.pluginbuilder/results/testresults/xml" 
            testmerge="*test.xml" >
            <depends>
                <project name="org.faktorips.util"/>
                <project name="org.faktorips.valuetypes"/>
                <project name="org.faktorips.dtflcommon"/>
                <project name="org.faktorips.runtime"/>
                <project name="org.faktorips.fl"/>
                <project name="org.faktorips.devtools.core"/>
                <project name="org.faktorips.devtools.stdbuilder"/>
                <project name="org.faktorips.devtools.core.ui"/>
                <project name="org.faktorips.devtools.ant"/>
            </depends>      
        </project>

        <project name="org.faktorips.integrationtest" mainbuildtarget="pluginbuilder.integrationtest" javaprojectname="org.faktorips.pluginbuilder"
            testresult="${workdir}/../pluginbuilder_tmp/org.faktorips.pluginbuilder/workspace/org.faktorips.integrationtest/results/xml" 
            testmerge="*Test.xml">
            <depends>
                <project name="org.faktorips.pluginbuilder"/>
            </depends>         
        </project>
        
<!-- 
TODO bbv, kqv und msgp 
-->
    </projects>
   
    <!-- cc publisher for several faktorips projects s-->
    <publishers>
        <!-- publisher htmlemail used in all projects -->
        <publisher id="htmlemail">
            <htmlemail 
                buildresultsurl="${buildresultsurl}/${project.name}"
                mailhost="${htmlemail.mailhost}"
                username=""
                password=""
                returnaddress="${htmlemail.returnaddress}"
                skipusers="false" 
                spamwhilebroken="false"
                returnname="faktorips-buildqueue"
                subjectprefix="[CC ${project.name}]"
                reportsuccess="always"
                xsldir="${htmlemail.xsldir}"
                css="${htmlemail.css}">
                
                <failure reportWhenFixed="true" address="htlmemail.reportWhenFixed.address" />
                
                <!-- mail mappings are specified in ENTITY mailmapping see this xml header -->
                &mailmapping;

            </htmlemail>
        </publisher>
        
        <!-- publisher for 'org.faktorips.pluginbuilder' copies the result of the automated test run to the cc log directory, 
             to bring it to the cc website -->
        <publisher project="org.faktorips.pluginbuilder" id="test.result.automated.test.result">
            <onsuccess>
                <antpublisher 
                     buildfile="${mainbuildfile}"
                     uselogger="true"
                     usedebug="false"
                     target="publish.pluginbuilder.faktorips.testdetails.html">
                    <property name="testdetails.dir" value="${logdir}/${project.name}/_cache"/>
                    <property name="lastbuildtimestamp" value="${cclastbuildtimestamp}"/>
                </antpublisher>
            </onsuccess>
            <onfailure>
                <antpublisher 
                     buildfile="${mainbuildfile}"
                     uselogger="true"
                     usedebug="false"
                     target="publish.pluginbuilder.faktorips.testdetails.html">
                    <property name="testdetails.dir" value="${logdir}/${project.name}/_cache"/>
                    <property name="lastbuildtimestamp" value="${cclastbuildtimestamp}"/>
                </antpublisher>
            </onfailure>        
        </publisher>
    </publishers>
    
</faktoripscruisecontrol>
